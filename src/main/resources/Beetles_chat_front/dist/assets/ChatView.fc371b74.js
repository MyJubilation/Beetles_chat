import{_ as m,r as d,c as I,o as y,w as x,a as c,b as t,t as p,F as C,d as w,u as B,g as _,e as i,n as k,f as M}from"./index.4f7c6964.js";const b={style:{height:"100%"}},S={style:{display:"flex","border-bottom":"1px #e5e7eb solid",height:"50px","align-items":"center"}},V={style:{"font-size":"20px",margin:"0 0 0 20px"}},H={class:"chatInfo"},z={style:{margin:"0","white-space":"pre-line"}},D={__name:"ChatView",setup(F){const s=d(null),g=sessionStorage.getItem("userId"),v=()=>{event.target!==s.value&&s.value.focus()},u=B(),o=I(()=>u.params.id),a=d([]),n=async()=>{try{const e=await _("/getChatHistory",{userId:sessionStorage.getItem("userId"),friendId:o.value});console.log(e),a.value=e.data,console.log(a.value)}catch(e){console.error("\u83B7\u53D6\u597D\u53CB\u5217\u8868\u5931\u8D25:",e)}},h=async()=>{console.log(s.value.value);try{const e=await _("/sendChatMessage",{userId:sessionStorage.getItem("userId"),friendId:o.value,chatMessage:s.value.value});console.log(e),n(),s.value.value=""}catch(e){console.error("\u83B7\u53D6\u597D\u53CB\u5217\u8868\u5931\u8D25:",e)}r()},r=()=>{const e=document.querySelector(".chatInfo");e&&(e.scrollTop=e.scrollHeight)};return y(()=>{console.log("\u7EC4\u4EF6\u5DF2\u6302\u8F7D\u5230 DOM"),r(),setInterval(n,3e3)}),x(()=>u.params.id,e=>{e&&(a.value="",o.value=e,n())},{immediate:!0}),(e,L)=>(i(),c("div",b,[t("div",S,[t("p",V,"BB\u53F7: "+p(o.value),1),t("a",{href:"#",style:{"margin-left":"auto","margin-right":"20px",width:"100px"},onClick:r,class:"scrollButtom"},"\u6ED1\u52A8\u5230\u5E95\u90E8")]),t("div",H,[(i(!0),c(C,null,w(a.value,(l,f)=>(i(),c("div",{key:f},[t("div",{class:k({friendInfo:l.id==o.value,selfInfo:l.id==M(g)})},[t("span",z,p(l.text),1)],2)]))),128))]),t("div",{class:"inputInfo",onClick:v},[t("textarea",{type:"text",ref_key:"textInput",ref:s,placeholder:""},null,512),t("div",null,[t("button",{class:"sendMsgButton",onClick:h},"\u53D1\u9001")])])]))}};var q=m(D,[["__scopeId","data-v-620e2d9a"]]);export{q as default};
